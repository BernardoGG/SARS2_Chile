lambda_tl$ptmrca, mu_tl$ptmrca, delta_tl$ptmrca),
ptmrca_date = c(alpha_tl$ptmrca_date, gamma_tl$ptmrca_date,
lambda_tl$ptmrca_date, mu_tl$ptmrca_date, delta_tl$ptmrca_date),
first_seen = c(alpha_tl$first_seen, gamma_tl$first_seen,
lambda_tl$first_seen, mu_tl$first_seen, delta_tl$first_seen),
first_seen_date = c(alpha_tl$first_seen_date, gamma_tl$first_seen_date,
lambda_tl$first_seen_date, mu_tl$first_seen_date, delta_tl$first_seen_date),
last_seen = c(alpha_tl$last_seen, gamma_tl$last_seen,
lambda_tl$last_seen, mu_tl$last_seen, delta_tl$last_seen),
last_seen_date = c(alpha_tl$last_seen_date, gamma_tl$last_seen_date,
lambda_tl$last_seen_date, mu_tl$last_seen_date, delta_tl$last_seen_date),
taxa = c(alpha_tl$taxa, gamma_tl$taxa, lambda_tl$taxa, mu_tl$taxa, delta_tl$taxa),
ntaxa = c(alpha_tl$ntaxa, gamma_tl$ntaxa, lambda_tl$ntaxa, mu_tl$ntaxa, delta_tl$ntaxa))
View(CL_singletons)
#### Unify data sets
## Singletons
CL_singletons <- data.frame(variant = c(rep("Alpha", nrow(alpha_tl)), rep("Gamma", nrow(gamma_tl)),
rep("Lambda", nrow(lambda_tl)), rep("Mu", nrow(mu_tl)),
rep("Delta", nrow(delta_tl))),
lineage = c(alpha_tl$lineage, gamma_tl$lineage,
lambda_tl$lineage, mu_tl$lineage, delta_tl$lineage),
tmrca = c(alpha_tl$tmrca, gamma_tl$tmrca,
lambda_tl$tmrca, mu_tl$tmrca, delta_tl$tmrca),
tmrca_date = c(alpha_tl$tmrca_date, gamma_tl$tmrca_date,
lambda_tl$tmrca_date, mu_tl$tmrca_date, delta_tl$tmrca_date),
ptmrca = c(alpha_tl$ptmrca, gamma_tl$ptmrca,
lambda_tl$ptmrca, mu_tl$ptmrca, delta_tl$ptmrca),
ptmrca_date = c(alpha_tl$ptmrca_date, gamma_tl$ptmrca_date,
lambda_tl$ptmrca_date, mu_tl$ptmrca_date, delta_tl$ptmrca_date),
first_seen = c(alpha_tl$first_seen, gamma_tl$first_seen,
lambda_tl$first_seen, mu_tl$first_seen, delta_tl$first_seen),
first_seen_date = c(alpha_tl$first_seen_date, gamma_tl$first_seen_date,
lambda_tl$first_seen_date, mu_tl$first_seen_date, delta_tl$first_seen_date),
last_seen = c(alpha_tl$last_seen, gamma_tl$last_seen,
lambda_tl$last_seen, mu_tl$last_seen, delta_tl$last_seen),
last_seen_date = c(alpha_tl$last_seen_date, gamma_tl$last_seen_date,
lambda_tl$last_seen_date, mu_tl$last_seen_date, delta_tl$last_seen_date),
taxa = c(alpha_tl$taxa, gamma_tl$taxa, lambda_tl$taxa, mu_tl$taxa, delta_tl$taxa),
ntaxa = c(alpha_tl$ntaxa, gamma_tl$ntaxa, lambda_tl$ntaxa, mu_tl$ntaxa, delta_tl$ntaxa)) %>%
filter(ntaxa == 1) %>% select(-ntaxa)
#### Unify data sets
## Full data set
CL_fertree <- data.frame(variant = c(rep("Alpha", nrow(alpha_tl)), rep("Gamma", nrow(gamma_tl)),
rep("Lambda", nrow(lambda_tl)), rep("Mu", nrow(mu_tl)),
rep("Delta", nrow(delta_tl))),
lineage = c(alpha_tl$lineage, gamma_tl$lineage,
lambda_tl$lineage, mu_tl$lineage, delta_tl$lineage),
tmrca = c(alpha_tl$tmrca, gamma_tl$tmrca,
lambda_tl$tmrca, mu_tl$tmrca, delta_tl$tmrca),
tmrca_date = c(alpha_tl$tmrca_date, gamma_tl$tmrca_date,
lambda_tl$tmrca_date, mu_tl$tmrca_date, delta_tl$tmrca_date),
ptmrca = c(alpha_tl$ptmrca, gamma_tl$ptmrca,
lambda_tl$ptmrca, mu_tl$ptmrca, delta_tl$ptmrca),
ptmrca_date = c(alpha_tl$ptmrca_date, gamma_tl$ptmrca_date,
lambda_tl$ptmrca_date, mu_tl$ptmrca_date, delta_tl$ptmrca_date),
first_seen = c(alpha_tl$first_seen, gamma_tl$first_seen,
lambda_tl$first_seen, mu_tl$first_seen, delta_tl$first_seen),
first_seen_date = c(alpha_tl$first_seen_date, gamma_tl$first_seen_date,
lambda_tl$first_seen_date, mu_tl$first_seen_date, delta_tl$first_seen_date),
last_seen = c(alpha_tl$last_seen, gamma_tl$last_seen,
lambda_tl$last_seen, mu_tl$last_seen, delta_tl$last_seen),
last_seen_date = c(alpha_tl$last_seen_date, gamma_tl$last_seen_date,
lambda_tl$last_seen_date, mu_tl$last_seen_date, delta_tl$last_seen_date),
taxa = c(alpha_tl$taxa, gamma_tl$taxa, lambda_tl$taxa, mu_tl$taxa, delta_tl$taxa),
ntaxa = c(alpha_tl$ntaxa, gamma_tl$ntaxa, lambda_tl$ntaxa, mu_tl$ntaxa, delta_tl$ntaxa))
## Singletons
CL_singletons <- CL_singletons %>% filter(ntaxa == 1) %>% select(-ntaxa)
View(CL_fertree)
is.numeric(CL_fertree$ntaxa)
## Singletons
CL_singletons <- CL_fertree %>% filter(ntaxa == 1) %>% select(-ntaxa)
## Transmission lineages
CL_TLs <- CL_fertree %>% filter(ntaxa != 1) %>% select(-taxa)
View(CL_singletons)
View(CL_TLs)
## Singletons
CL_singletons <- CL_fertree %>% filter(ntaxa == 1) %>% mutate(seen = first_seen)
## Singletons
CL_singletons <- CL_fertree %>% filter(ntaxa == 1) %>% mutate(seen = first_seen) %>%
select(-ntaxa, -first_seen, -first_seen_date, -last_seen, -last_seen_date)
## Singletons
CL_singletons <- CL_fertree %>% filter(ntaxa == 1) %>% mutate(seen = first_seen) %>% mutate(seen_date = first_seen_date) %>%
select(-ntaxa, -first_seen, -first_seen_date, -last_seen, -last_seen_date)
########################### Plot TLs in Chile ##################################
# Singleton collection times per variant
ggplot() + geom_histogram(aes(x = seen_date))
########################### Plot TLs in Chile ##################################
# Singleton collection times per variant
ggplot() + geom_histogram(CL_singletons, aes(x = seen_date))
########################### Plot TLs in Chile ##################################
# Singleton collection times per variant
ggplot() + geom_histogram(CL_singletons, aes(seen_date))
########################### Plot TLs in Chile ##################################
# Singleton collection times per variant
ggplot() + geom_histogram(CL_singletons, aes(seen))
########################### Plot TLs in Chile ##################################
# Singleton collection times per variant
ggplot() + geom_freqpoly(CL_singletons, aes(seen))
########################### Plot TLs in Chile ##################################
# Singleton collection times per variant
ggplot() + geom_freqpoly(CL_singletons, aes(x = seen))
########################### Plot TLs in Chile ##################################
# Singleton collection times per variant
ggplot(CL_singletons, aes(x = seen)) + geom_freqpoly()
########################### Plot TLs in Chile ##################################
# Singleton collection times per variant
ggplot(CL_singletons, aes(x = seen, color = variant)) + geom_freqpoly()
# TL earliest collection times per variant
ggplot(CL_TLs, aes(x = seen_first, color = variant)) + geom_freqpoly()
# TL earliest collection times per variant
ggplot(CL_TLs, aes(x = first_seen, color = variant)) + geom_freqpoly()
########################### Plot TLs in Chile ##################################
# Singleton collection times per variant
ggplot(CL_singletons, aes(x = seen, color = variant)) + geom_freqpoly() + title("Singletons")
########################### Plot TLs in Chile ##################################
# Singleton collection times per variant
ggplot(CL_singletons, aes(x = seen, color = variant)) + geom_freqpoly() + labs(title = "Singletons")
# TL earliest collection times per variant
ggplot(CL_TLs, aes(x = first_seen, color = variant)) + geom_freqpoly() + labs(title = "Transmission lineages")
# TL earliest collection times per variant
ggplot(CL_TLs, aes(x = tmrca, color = variant)) + geom_freqpoly() + labs(title = "Transmission lineages (TMRCA)")
########################### Plot TLs in Chile ##################################
# Singleton collection times per variant
ggplot(CL_singletons, aes(x = seen, color = variant)) + geom_freqpoly(binwidth = 0.02) + labs(title = "Singletons")
########################### Plot TLs in Chile ##################################
# Singleton collection times per variant
ggplot(CL_singletons, aes(x = seen, color = variant)) + geom_freqpoly(binwidth = 0.04) + labs(title = "Singletons")
########################### Plot TLs in Chile ##################################
# Singleton collection times per variant
ggplot(CL_singletons, aes(x = seen, color = variant)) + geom_freqpoly(binwidth = 0.08) + labs(title = "Singletons")
########################### Plot TLs in Chile ##################################
# Singleton collection times per variant
ggplot(CL_singletons, aes(x = seen, color = variant)) + geom_freqpoly(binwidth = 0.04) + labs(title = "Singletons")
# TL earliest collection times per variant
ggplot(CL_TLs, aes(x = first_seen, color = variant)) + geom_freqpoly(binwidth = 0.04) + labs(title = "Transmission lineages (earliest detection)")
# TL earliest collection times per variant
ggplot(CL_TLs, aes(x = tmrca, color = variant)) + geom_freqpoly(binwidth = 0.04) + labs(title = "Transmission lineages (TMRCA)")
# TL pTMRCAs per variant
ggplot(CL_TLs, aes(x = ptmrca, color = variant)) + geom_freqpoly(binwidth = 0.04) + labs(title = "Transmission lineages (pTMRCA)")
########################### Plot TLs in Chile ##################################
# Singleton collection times per variant
ggplot(CL_singletons, aes(x = seen, color = variant)) +
geom_freqpoly(binwidth = 0.04, size = 2) + labs(title = "Singletons") +
theme_minimal() + scale_color_manual(values = vocs_colors) +
theme(axis.title.x = "Sample collection date",
axis.text.x = element_text(size = 14))
########################### Plot TLs in Chile ##################################
# Singleton collection times per variant
ggplot(CL_singletons, aes(x = seen, color = variant)) +
geom_freqpoly(binwidth = 0.04, size = 2) + labs(title = "Singletons") +
theme_minimal() + scale_color_manual(values = vocs_colors) +
theme(title = "Singletons",
axis.text.x = "Sample collection date",
axis.text.x = element_text(size = 14))
########################### Plot TLs in Chile ##################################
# Singleton collection times per variant
ggplot(CL_singletons, aes(x = seen, color = variant)) +
geom_freqpoly(binwidth = 0.04, size = 2) +
labs(title = "Singletons", x = "Sample collection date") +
theme_minimal() + scale_color_manual(values = vocs_colors) +
theme(title = "Singletons", axis.text.x = element_text(size = 14))
########################### Plot TLs in Chile ##################################
# Singleton collection times per variant
ggplot(CL_singletons, aes(x = seen, color = variant)) +
geom_freqpoly(binwidth = 0.04, size = 2) +
labs(title = "Singletons", x = "Sample collection date") +
theme_minimal() + scale_color_manual(values = vocs_colors) +
theme(axis.text.x = element_text(size = 14))
########################### Plot TLs in Chile ##################################
# Singleton collection times per variant
ggplot(CL_singletons, aes(x = seen, color = variant)) +
geom_freqpoly(binwidth = 0.04, size = 1.5) +
labs(title = "Singletons", x = "Sample collection date") +
theme_minimal() + scale_color_manual(values = vocs_colors) +
theme(axis.text.x = element_text(size = 14))
########################### Plot TLs in Chile ##################################
# Singleton collection times per variant
ggplot(CL_singletons, aes(x = seen, color = variant)) +
geom_freqpoly(binwidth = 0.04, size = 1.5) +
labs(title = "Singletons", x = "Sample collection date") +
theme_minimal() + scale_color_manual(values = vocs_colors) +
theme(axis.text.x = element_text(size = 10))
########################### Plot TLs in Chile ##################################
# Singleton collection times per variant
ggplot(CL_singletons, aes(x = seen, color = variant)) +
geom_freqpoly(binwidth = 0.04, size = 1.5) +
labs(title = "Singletons", x = "Sample collection date",
y = "No. singletons observed per week") +
theme_minimal() + scale_color_manual(values = vocs_colors) +
theme(axis.text.x = element_text(size = 10))
########################### Plot TLs in Chile ##################################
# Singleton collection times per variant
ggplot(CL_singletons, aes(x = seen, color = variant)) +
geom_freqpoly(binwidth = 0.04, size = 1.5) +
labs(title = "Singletons", x = "Sample collection date",
y = "No. singletons observed per week") +
theme_minimal() + scale_color_manual(values = vocs_colors) +
theme(axis.title.x = element_text(size = 14))
########################### Plot TLs in Chile ##################################
# Singleton collection times per variant
ggplot(CL_singletons, aes(x = seen, color = variant)) +
geom_freqpoly(binwidth = 0.04, size = 1.5) +
labs(title = "Singletons", x = "Sample collection date",
y = "No. singletons observed per week") +
theme_minimal() + scale_color_manual(values = vocs_colors) +
theme(axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14))
########################### Plot TLs in Chile ##################################
# Singleton collection times per variant
ggplot(CL_singletons, aes(x = seen, color = variant)) +
geom_freqpoly(binwidth = 0.04, size = 1.5) +
labs(title = "Singletons", x = "Sample collection date",
y = "No. singletons observed per week") +
theme_minimal() + scale_color_manual(values = vocs_colors) +
theme(axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12))
########################### Plot TLs in Chile ##################################
# Singleton collection times per variant
ggplot(CL_singletons, aes(x = seen, color = variant)) +
geom_freqpoly(binwidth = 0.04, size = 1.5) +
labs(title = "Singletons", x = "Sample collection date",
y = "No. singletons observed per week",
color = "Variant") +
theme_minimal() + scale_color_manual(values = vocs_colors) +
theme(axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12))
########################### Plot TLs in Chile ##################################
# Singleton collection times per variant
ggplot(CL_singletons, aes(x = seen, color = variant)) +
geom_freqpoly(binwidth = 0.04, size = 1.5) +
labs(title = "Singletons", x = "Sample collection date",
y = "No. singletons observed per week",
color = "Variant") +
theme_minimal() + scale_color_manual(values = vocs_colors) +
theme(axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 14),
legend.text = element_text(size = 14))
########################### Plot TLs in Chile ##################################
# Singleton collection times per variant
ggplot(CL_singletons, aes(x = seen, color = variant)) +
geom_freqpoly(binwidth = 0.04, size = 1.5) +
labs(title = "Singletons", x = "Sample collection date",
y = "No. singletons observed per week",
color = "Variant") +
theme_minimal() + scale_color_manual(values = vocs_colors) +
theme(axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 14),
legend.text = element_text(size = 12))
########################### Plot TLs in Chile ##################################
# Singleton collection times per variant
ggplot(CL_singletons, aes(x = seen, color = variant)) +
geom_freqpoly(binwidth = 0.04, size = 1.5) +
labs(x = "Sample collection date",
y = "No. singletons observed per week",
color = "Variant") +
theme_minimal() + scale_color_manual(values = vocs_colors) +
theme(axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 14),
legend.text = element_text(size = 12))
# TL earliest collection times per variant
ggplot(CL_TLs, aes(x = first_seen, color = variant)) +
geom_freqpoly(binwidth = 0.04, size = 1.5) +
labs(x = "First detection of TL",
y = "No. TLs first observed per week",
color = "Variant") +
theme_minimal() + scale_color_manual(values = vocs_colors) +
theme(axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 14),
legend.text = element_text(size = 12))
# TL TMRCAs per variant
ggplot(CL_TLs, aes(x = tmrca, color = variant)) +
geom_freqpoly(binwidth = 0.04, size = 1.5) +
labs(x = "TL TMRCA",
y = "No. TL introductions per week*",
color = "Variant") +
theme_minimal() + scale_color_manual(values = vocs_colors) +
theme(axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 14),
legend.text = element_text(size = 12))
# TL earliest collection times per variant
ggplot(CL_TLs, aes(x = first_seen, color = variant)) +
geom_freqpoly(binwidth = 0.04, size = 1.5) +
labs(x = "First detection of TL",
y = "No. TLs first observed per week",
color = "Variant") +
theme_minimal() + scale_color_manual(values = vocs_colors) +
xlim(2020.8, 2021.8) +
theme(axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 14),
legend.text = element_text(size = 12))
# TL earliest collection times per variant
ggplot(CL_TLs, aes(x = first_seen, color = variant)) +
geom_freqpoly(binwidth = 0.04, size = 1.5) +
labs(x = "First detection of TL",
y = "No. TLs first observed per week",
color = "Variant") +
theme_minimal() + scale_color_manual(values = vocs_colors) +
xlim(2020.85, 2021.85) +
theme(axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 14),
legend.text = element_text(size = 12))
########################### Plot TLs in Chile ##################################
# Singleton collection times per variant
ggplot(CL_singletons, aes(x = seen, color = variant)) +
geom_freqpoly(binwidth = 0.04, size = 1.5) +
labs(x = "Sample collection date",
y = "No. singletons observed per week",
color = "Variant") +
theme_minimal() + scale_color_manual(values = vocs_colors) +
xlim(2020.85, 2021.85) +
theme(axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 14),
legend.text = element_text(size = 12))
# TL earliest collection times per variant
ggplot(CL_TLs, aes(x = first_seen, color = variant)) +
geom_freqpoly(binwidth = 0.04, size = 1.5) +
labs(x = "First detection of TL",
y = "No. TLs first observed per week",
color = "Variant") +
theme_minimal() + scale_color_manual(values = vocs_colors) +
xlim(2020.85, 2021.85) +
theme(axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 14),
legend.text = element_text(size = 12))
# TL TMRCAs per variant
ggplot(CL_TLs, aes(x = tmrca, color = variant)) +
geom_freqpoly(binwidth = 0.04, size = 1.5) +
labs(x = "TL TMRCA",
y = "No. TL introductions per week*",
color = "Variant") +
theme_minimal() + scale_color_manual(values = vocs_colors) +
xlim(2020.85, 2021.85) +
theme(axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 14),
legend.text = element_text(size = 12))
# TL pTMRCAs per variant
ggplot(CL_TLs, aes(x = ptmrca, color = variant)) +
geom_freqpoly(binwidth = 0.04, size = 1.5) +
labs(x = "TL parent TMRCA",
y = "No. TL introductions per week*",
color = "Variant") +
theme_minimal() + scale_color_manual(values = vocs_colors) +
xlim(2020.85, 2021.85) +
theme(axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 14),
legend.text = element_text(size = 12))
########################### Plot TLs in Chile ##################################
# Singleton collection times per variant
ggplot(CL_singletons, aes(x = seen, color = variant)) +
geom_freqpoly(binwidth = 0.04, size = 1.5) +
labs(x = "Sample collection date",
y = "No. of singletons observed per week",
color = "Variant") +
theme_minimal() + scale_color_manual(values = vocs_colors) +
xlim(2020.85, 2021.85) +
theme(axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 14),
legend.text = element_text(size = 12))
# TL earliest collection times per variant
ggplot(CL_TLs, aes(x = first_seen, color = variant)) +
geom_freqpoly(binwidth = 0.04, size = 1.5) +
labs(x = "First detection of TL",
y = "No. of TLs first observed per week",
color = "Variant") +
theme_minimal() + scale_color_manual(values = vocs_colors) +
xlim(2020.85, 2021.85) +
theme(axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 14),
legend.text = element_text(size = 12))
# TL TMRCAs per variant
ggplot(CL_TLs, aes(x = tmrca, color = variant)) +
geom_freqpoly(binwidth = 0.04, size = 1.5) +
labs(x = "TL TMRCA",
y = "No. of TL introductions per week*",
color = "Variant") +
theme_minimal() + scale_color_manual(values = vocs_colors) +
xlim(2020.85, 2021.85) +
theme(axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 14),
legend.text = element_text(size = 12))
########################### Plot TLs in Chile ##################################
# Singleton collection times per variant
ggplot(CL_singletons, aes(x = seen, color = variant)) +
geom_freqpoly(binwidth = 0.04, size = 1.5) +
labs(x = "Sample collection date",
y = "No. of singletons observed per week",
color = "Variant") +
theme_minimal() + scale_color_manual(values = vocs_colors) +
xlim(2020.85, 2021.85) +
theme(axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 14),
legend.text = element_text(size = 12))
# Singleton collection times per variant
ggplot(CL_singletons, aes(x = tmrca, color = variant)) +
geom_freqpoly(binwidth = 0.04, size = 1.5) +
labs(x = "Parent node age",
y = "No. of singletons observed per week",
color = "Variant") +
theme_minimal() + scale_color_manual(values = vocs_colors) +
xlim(2020.85, 2021.85) +
theme(axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 14),
legend.text = element_text(size = 12))
CL_fertree$taxa[CL_fertree$ntaxa != 1]
# TL sizes per variant
ggplot(CL_TLs, aes(x = lineage, y = ntaxa, fill = variant)) +
geom_col() +
labs(x = "Transmission lineage",
y = "No. of sequences per TL",
fill = "Variant") +
theme_minimal() + scale_color_manual(values = vocs_colors) +
theme(axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 14),
legend.text = element_text(size = 12))
# TL sizes per variant
ggplot(CL_TLs, aes(x = lineage, y = sort(ntaxa), fill = variant)) +
geom_col() +
labs(x = "Transmission lineage",
y = "No. of sequences per TL",
fill = "Variant") +
theme_minimal() + scale_color_manual(values = vocs_colors) +
theme(axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 14),
legend.text = element_text(size = 12))
?sort
# TL sizes per variant
ggplot(CL_TLs, aes(x = lineage, y = sort(ntaxa, decreasing = TRUE), fill = variant)) +
geom_col() +
labs(x = "Transmission lineage",
y = "No. of sequences per TL",
fill = "Variant") +
theme_minimal() + scale_color_manual(values = vocs_colors) +
theme(axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 14),
legend.text = element_text(size = 12))
# TL sizes per variant
ggplot(CL_TLs[order(ntaxa),],
aes(x = lineage, y = ntaxa, fill = variant)) +
geom_col() +
labs(x = "Transmission lineage",
y = "No. of sequences per TL",
fill = "Variant") +
theme_minimal() + scale_color_manual(values = vocs_colors) +
theme(axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 12),
legend.title = element_text(size = 14),
legend.text = element_text(size = 12))
CL_TLs[order(ntaxa),]
order(CL_TLs$ntaxa)
